"use strict";(self.webpackChunksalarioemocionalfrontend=self.webpackChunksalarioemocionalfrontend||[]).push([[338],{6338:(Q,v,o)=>{o.r(v),o.d(v,{AdminModule:()=>M});var C=o(428),B=o(3162),A=o(6208),f=o(3912),e=o(6689),Z=o(833),y=o(9139);let F=(()=>{class a{static#e=this.\u0275fac=function(t){return new(t||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["admin-sidebar"]],decls:6,vars:0,consts:[[1,"sidebar-sticky"],[1,"nav","flex-column","py-2"],[1,"nav-item"],["href","#",1,"nav-link","active"],[1,"fa-solid","fa-house"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"ul",1)(2,"li",2)(3,"a",3),e._UZ(4,"i",4),e._uU(5," General "),e.qZA()()()())},encapsulation:2})}return a})(),T=(()=>{class a{static#e=this.\u0275fac=function(t){return new(t||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-container"]],decls:9,vars:0,consts:[[1,"container-fluid","pb-3"],[1,"row"],[1,"col-md-2","d-none","d-md-block","bg-light","sidebar","position-fixed","h-100","shadow"],[1,"col-md-2","ml-sm-auto","col-lg-2","pt-3","px-4"],["role","main",1,"col-md-10","ml-sm-auto","col-lg-10","pt-3","px-4"]],template:function(t,n){1&t&&(e._UZ(0,"offcanvas")(1,"app-navbar"),e.TgZ(2,"div",0)(3,"div",1)(4,"nav",2),e._UZ(5,"admin-sidebar"),e.qZA(),e._UZ(6,"div",3),e.TgZ(7,"main",4),e._UZ(8,"router-outlet"),e.qZA()()())},dependencies:[f.lC,Z.S,y.I,F],encapsulation:2})}return a})();var d=o(6223),U=o(2572),u=o(627),w=o(4702),h=o(591),S=o(2369),p=o(9862),D=o(553);let G=(()=>{class a{constructor(i){this.http=i,this.apiBaseUrl=D.N.apiBaseUrl,this.token=localStorage.getItem("token")}getAllBenefitUser(i){let t=this.cleanParams(i);const n=(new p.WM).set("Accept","application/json").set("Authorization",`Bearer ${localStorage.getItem("token")}`);return this.http.get(`${this.apiBaseUrl}/admin/getAllBenefitUser`,{params:t,headers:n,withCredentials:!0})}getAllGroupedBenefits(i){let t=this.cleanParams(i);const n=(new p.WM).set("Accept","application/json").set("Authorization",`Bearer ${localStorage.getItem("token")}`);return this.http.get(`${this.apiBaseUrl}/admin/getAllGroupedBenefits`,{params:t,headers:n,withCredentials:!0})}cleanParams(i){const t=new p.LE({fromObject:i});return t.keys().forEach(s=>{const c=t.get(s);(null===c||"null"===c||void 0===c||""===c)&&t.map.delete(s)}),t}static#e=this.\u0275fac=function(t){return new(t||a)(e.LFG(p.eN))};static#t=this.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var O=o(2278),J=o(8162),x=o(9913),b=o(6814),V=o(9366),N=o(6760),E=o(2160),j=o(6340);const I=function(a){return{"d-none":a}},L=[{path:"",component:T,children:[{path:"all-benefit-user",component:(()=>{class a{constructor(i,t,n,s,c,m){this.adminService=i,this.as=t,this.benefitService=n,this.dependencyService=s,this.fb=c,this.userService=m,this.formGroup=this.fb.group({year:[new Date,d.kI.required],benefit_id:[""],user_id:[""],dependency_id:[""],is_approved:[""]}),this.allBenefits=[],this.approvedBenefits=[],this.benefits=[],this.dependencies=[],this.dtOptions={},this.loaded=!1,this.pendingBenefits=[],this.rejectedBenefits=[],this.status=[{name:"Aprobado",value:1},{name:"Rechazado",value:2},{name:"Pendiente",value:0}],this.users=[],this.columns=[{title:"Dependencia",data:"user.dependency.name"},{title:"Colaborador",data:"user.name"},{title:"Beneficio",data:"benefits.name"},{title:"Detalle",data:"benefit_detail.name"},{title:"Solicitado",data:function(r,l,g){return new Date(r.created_at).toLocaleString("es-CO")}},{title:"Fecha y hora de redenci\xf3n",data:function(r,l,g){return new Date(r.benefit_begin_time).toLocaleString("es-CO")}},{title:"Estado",data:function(r,l,g){switch(r.is_approved){case 0:return"Pendiente de Aprobaci\xf3n";case 1:return"Aprobado";case 2:return"Rechazado";default:return"No definido"}}},{title:"Opciones",data:function(r,l,g){return`\n          <span style="cursor: pointer;" benefit_user_id="${r.id}" class="badge rounded-pill text-bg-warning">\n            Detalles\n            <i class="fa-solid fa-circle-info fa-fade" style="color: #000000;"></i>\n          </span>`}}],this.barChartData={labels:[],datasets:[]}}ngOnInit(){this.getBenefits(),$.fn.dataTable.ext.search.push((i,t,n)=>!0),this.dtOptions={columns:this.columns}}fillBenefits(i){this.allBenefits=i,this.approvedBenefits=i.filter(t=>1===t.is_approved),this.rejectedBenefits=i.filter(t=>2===t.is_approved),this.pendingBenefits=i.filter(t=>0===t.is_approved),this.dtOptions={data:this.allBenefits,columns:this.columns,responsive:!0,language:S}}getBenefits(){this.loaded=!1,this.formGroup.value.year=new Date(this.formGroup.value.year).getFullYear(),(0,U.a)({allBenefits:this.adminService.getAllBenefitUser(this.formGroup.value),benefits:this.benefitService.index(),dependencies:this.dependencyService.getNonTreeValidDependencies(),groupedBenefits:this.adminService.getAllGroupedBenefits(this.formGroup.value),users:this.userService.index()}).subscribe({next:({allBenefits:i,benefits:t,dependencies:n,groupedBenefits:s,users:c})=>{this.fillBenefits(i),this.benefits=t,this.dependencies=n,this.users=c,this.barChartData.labels=Object.keys(s).map(l=>l);let r=[];r=[{data:this.barChartData.labels.map(l=>Object.values(s[l]).length),backgroundColor:["#FFC3A0","#FFD8A8","#B8D8FF","#C2FFD8","#FFEAB8","#B8FFE8","#FFF9C2","#B8F5FF","#FFB8F5","#FFC2B8","#E4FFC2","#C2B8FF","#FFB8D8","#FFD8B8","#E8B8FF","#FFE8B8"]}],this.barChartData={datasets:r,labels:this.barChartData.labels},this.loaded=!0,this.datatableElement.dtInstance.then(l=>{l.clear().rows.add(this.allBenefits).draw()})},error:({error:i})=>this.as.subscriptionAlert(h.fI.ERROR,h.gW.ERROR,i.message)})}resetForm(){this.formGroup.get("benefit_id")?.reset(),this.formGroup.get("user_id")?.reset(),this.formGroup.get("dependency_id")?.reset(),this.formGroup.get("is_approved")?.reset(),this.getBenefits()}static#e=this.\u0275fac=function(t){return new(t||a)(e.Y36(G),e.Y36(h.c9),e.Y36(O.T),e.Y36(J.u),e.Y36(d.qu),e.Y36(x.K))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-view-all-benefit-user"]],viewQuery:function(t,n){if(1&t&&(e.Gf(w.jh,5),e.Gf(u.G,5)),2&t){let s;e.iGM(s=e.CRH())&&(n.chart=s.first),e.iGM(s=e.CRH())&&(n.datatableElement=s.first)}},decls:66,vars:17,consts:[["styleClass","mb-4"],[1,"row"],[1,"col-11"],[3,"formGroup"],[1,"breadcrumb"],[1,"breadcrumb-item"],["formControlName","year","view","year","dateFormat","yy","inputId","yearpicker",3,"ngModelChange"],["optionLabel","name","optionValue","id","formControlName","benefit_id","placeholder","-- Seleccione Beneficio --",3,"filter","options","onChange"],["optionLabel","name","optionValue","id","formControlName","user_id","placeholder","-- Seleccione Colaborador --",3,"filter","options","onChange"],["optionLabel","name","optionValue","id","formControlName","dependency_id","placeholder","-- Seleccione Dependencia --",3,"filter","options","onChange"],["optionLabel","name","optionValue","value","formControlName","is_approved","placeholder","-- Seleccione Estado --",3,"options","onChange"],[1,"col-1","d-flex","flex-column","justify-content-evenly"],["type","button",1,"btn","btn-outline-secondary","border",3,"click"],[1,"fa-solid","fa-rotate-right"],[1,"btn","btn-outline-secondary","border",3,"ngClass"],[1,"fa-solid","fa-spinner","fa-spin","fa-xs"],[1,"row","p-3"],[1,"col-12","col-sm-6","col-lg-3","px-5"],[1,"card","text-bg-info","mb-3","shadow"],[1,"card-header"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"card","text-bg-success","mb-3","shadow"],[1,"card","text-bg-danger","mb-3","shadow"],[1,"card","text-bg-warning","mb-3","shadow"],[3,"barChartData"],["chart",""],[1,"row","mt-5"],[1,"col"],["datatable","",1,"table","table-hover","table-sm","table-striped",3,"dtOptions"],[1,"bg-dark","text-light"]],template:function(t,n){1&t&&(e.TgZ(0,"p-toolbar",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"nav",4)(5,"ol",4)(6,"li",5)(7,"p-calendar",6),e.NdJ("ngModelChange",function(){return n.getBenefits()}),e.qZA()(),e.TgZ(8,"li",5)(9,"p-dropdown",7),e.NdJ("onChange",function(){return n.getBenefits()}),e.qZA()(),e.TgZ(10,"li",5)(11,"p-dropdown",8),e.NdJ("onChange",function(){return n.getBenefits()}),e.qZA()()(),e.TgZ(12,"ol",4)(13,"li",5)(14,"p-dropdown",9),e.NdJ("onChange",function(){return n.getBenefits()}),e.qZA()(),e.TgZ(15,"li",5)(16,"p-dropdown",10),e.NdJ("onChange",function(){return n.getBenefits()}),e.qZA()()()()()(),e.TgZ(17,"div",11)(18,"button",12),e.NdJ("click",function(){return n.resetForm()}),e._UZ(19,"i",13),e.qZA(),e.TgZ(20,"button",14),e._UZ(21,"i",15),e.qZA()()()(),e.TgZ(22,"div",16)(23,"div",17)(24,"div",18)(25,"div",19),e._uU(26,"Todos los Beneficios"),e.qZA(),e.TgZ(27,"div",20)(28,"h5",21),e._uU(29,"Total"),e.qZA(),e.TgZ(30,"h5",22),e._uU(31),e.qZA()()()(),e.TgZ(32,"div",17)(33,"div",23)(34,"div",19),e._uU(35,"Beneficios aprobados"),e.qZA(),e.TgZ(36,"div",20)(37,"h5",21),e._uU(38,"Total"),e.qZA(),e.TgZ(39,"h5",22),e._uU(40),e.qZA()()()(),e.TgZ(41,"div",17)(42,"div",24)(43,"div",19),e._uU(44,"Beneficios rechazados"),e.qZA(),e.TgZ(45,"div",20)(46,"h5",21),e._uU(47,"Total"),e.qZA(),e.TgZ(48,"h5",22),e._uU(49),e.qZA()()()(),e.TgZ(50,"div",17)(51,"div",25)(52,"div",19),e._uU(53,"En aprobaci\xf3n"),e.qZA(),e.TgZ(54,"div",20)(55,"h5",21),e._uU(56,"Total"),e.qZA(),e.TgZ(57,"h5",22),e._uU(58),e.qZA()()()()(),e._UZ(59,"bar-chart-component",26,27),e.TgZ(61,"div",28)(62,"div",29)(63,"table",30),e._UZ(64,"thead",31)(65,"tbody"),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",n.formGroup),e.xp6(6),e.Q6J("filter",!0)("options",n.benefits),e.xp6(2),e.Q6J("filter",!0)("options",n.users),e.xp6(3),e.Q6J("filter",!0)("options",n.dependencies),e.xp6(2),e.Q6J("options",n.status),e.xp6(4),e.Q6J("ngClass",e.VKq(15,I,n.loaded)),e.xp6(11),e.Oqu(n.allBenefits.length),e.xp6(9),e.Oqu(n.approvedBenefits.length),e.xp6(9),e.Oqu(n.rejectedBenefits.length),e.xp6(9),e.Oqu(n.pendingBenefits.length),e.xp6(1),e.Q6J("barChartData",n.barChartData),e.xp6(4),e.Q6J("dtOptions",n.dtOptions))},dependencies:[b.mk,V.u,u.G,N.f,E.Lt,j.o,d._Y,d.JJ,d.JL,d.sg,d.u],encapsulation:2})}return a})()},{path:"**",redirectTo:"all-benefit-user"}]}];let R=(()=>{class a{static#e=this.\u0275fac=function(t){return new(t||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({imports:[f.Bz.forChild(L),f.Bz]})}return a})(),M=(()=>{class a{static#e=this.\u0275fac=function(t){return new(t||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({imports:[R,b.ez,C.m,u.T,B.W,d.UX,A.m]})}return a})()}}]);