"use strict";(self.webpackChunksalarioemocionalfrontend=self.webpackChunksalarioemocionalfrontend||[]).push([[375],{6375:(W,h,s)=>{s.r(h),s.d(h,{DependencyModule:()=>z});var c=s(6814),o=s(6223),f=s(627),C=s(6208),d=s(180),S=s(1107),g=s(4664),r=s(591),e=s(6689),u=s(8162),R=s(1230),x=s(2746);function A(n,p){1&n&&(e.TgZ(0,"small",12),e._uU(1,"Obligatorio"),e.qZA())}const T=function(n){return{invalid:n}};let v=(()=>{class n{get nameErrorMsg(){const t=this.createForm.get("name")?.errors;return t.minlength?"El nombre no cumple con el largo m\xednimo de 6 caracteres":t.required?"El nombre es obligatorio":""}constructor(t,i,a,l,m){this.activatedRoute=t,this.as=i,this.fb=a,this.dependencyService=l,this.router=m,this.createForm=this.fb.group({name:["",[o.kI.required,o.kI.minLength(5)]],parent_id:["",o.kI.required]}),this.disableSubmitBtn=!1,this.loaded=!1}ngOnInit(){this.dependencyService.index().subscribe({next:t=>{this.dependencies=t,this.nodes=[this.dependencyService.buildDependencyTreeNode(t[0])]},error:({error:t})=>{this.router.navigateByUrl("dependency"),this.as.subscriptionAlert(r.fI.ERROR,r.gW.ERROR,t.message)}}),this.router.url.includes("edit")&&this.activatedRoute.params.pipe((0,g.w)(({id:t})=>this.dependencyService.show(t))).subscribe(t=>{this.dependency=Object.values(t)[0];let i=this.dependencyService.flattenDependency({...this.dependencies[0]}).find(a=>a.id===this.dependency?.parent_id);this.createForm.reset({name:this.dependency?.name,parent_id:this.dependencyService.makeNode(i)}),this.loaded=!0})}campoEsValido(t){return this.createForm.controls[t].errors&&this.createForm.controls[t].touched}save(){if(this.createForm.invalid)this.createForm.markAllAsTouched();else{if(this.dependency?.id){let t=this.dependencyService.flattenDependency({...this.dependencies[0]}).find(i=>this.createForm.get("parent_id")?.value.label===i.name);this.createForm.get("parent_id")?.setValue(t?.id),this.dependencyService.update(this.dependency.id,this.createForm.value).subscribe({next:()=>{this.router.navigateByUrl(`/dependency/show/${this.dependency?.id}`),this.as.subscriptionAlert(r.fI.ACTUALIZADO,r.gW.SUCCESS,"Actualizado")},error:({error:i})=>{this.as.subscriptionAlert(r.fI.ERROR,r.gW.ERROR,i.message),this.disableSubmitBtn=!1}})}else{let t=this.dependencyService.flattenDependency({...this.dependencies[0]}).find(i=>this.createForm.get("parent_id")?.value.label===i.name);this.createForm.get("parent_id")?.setValue(t?.id),this.dependencyService.create(this.createForm.value).subscribe({next:i=>{this.router.navigateByUrl(`/dependency/show/${i.id}`),this.as.subscriptionAlert(r.fI.CREADO,r.gW.SUCCESS,"Creado")},error:({error:i})=>{this.as.subscriptionAlert(r.fI.ERROR,r.gW.ERROR,i.message),this.disableSubmitBtn=!1}})}this.disableSubmitBtn=!0}}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(d.gz),e.Y36(r.c9),e.Y36(o.qu),e.Y36(u.u),e.Y36(d.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["user-create"]],decls:16,vars:9,consts:[[1,"row"],[1,"col"],[1,"p-5",3,"formGroup","ngSubmit"],[1,"mb-3"],["header","Informaci\xf3n de la dependencia"],[1,"mb-3","form-floating"],["type","text","formControlName","name","id","name","placeholder","Nombre Completo",1,"form-control",3,"ngClass"],["for","name",1,"form-label"],[1,"fa-solid","fa-box","me-1"],["class","text-danger",4,"ngIf"],["containerStyleClass","w-100","formControlName","parent_id","placeholder","-- Seleccione Dependencia --","data-","id",1,"md:w-20rem","w-100",3,"options","filter"],["type","submit",1,"btn","btn-success","float-end",3,"disabled"],[1,"text-danger"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return a.save()}),e.TgZ(3,"div",3)(4,"p-panel",4)(5,"div",5),e._UZ(6,"input",6),e.TgZ(7,"label",7),e._UZ(8,"i",8),e._uU(9,"Nombre de la Dependencia"),e.qZA(),e.YNc(10,A,2,0,"small",9),e.qZA(),e.TgZ(11,"div",3),e._UZ(12,"p-treeSelect",10),e.qZA()()(),e.TgZ(13,"div",3)(14,"button",11),e._uU(15),e.qZA()()()()()),2&i&&(e.xp6(2),e.Q6J("formGroup",a.createForm),e.xp6(4),e.Q6J("ngClass",e.VKq(7,T,a.campoEsValido("name"))),e.xp6(4),e.Q6J("ngIf",a.campoEsValido("name")),e.xp6(2),e.Q6J("options",a.nodes)("filter",!0),e.xp6(2),e.Q6J("disabled",a.disableSubmitBtn),e.xp6(1),e.hij(" ",null!=a.dependency&&a.dependency.id?"Actualizar":"Crear"," "))},dependencies:[c.mk,c.O5,o._Y,o.Fj,o.JJ,o.JL,R.s,x.mP,o.sg,o.u],encapsulation:2})}return n})();var Z=s(2369),O=s(5219),I=s(6748),b=s(4844);function E(n,p){if(1&n&&(e.TgZ(0,"table",3),e._UZ(1,"thead",4)(2,"tbody"),e.qZA()),2&n){const t=e.oxw();e.Q6J("dtOptions",t.dtOptions)}}function U(n,p){if(1&n&&(e.TgZ(0,"div",7),e._uU(1),e.qZA()),2&n){const t=p.$implicit;e.xp6(1),e.hij(" ",t.label," ")}}function F(n,p){if(1&n&&(e.TgZ(0,"p-organizationChart",5),e.YNc(1,U,2,1,"ng-template",6),e.qZA()),2&n){const t=e.oxw();e.Q6J("value",t.nodes)}}let w=(()=>{class n{constructor(t,i,a,l){this.as=t,this.dependencyService=i,this.renderer=a,this.router=l,this.columns=[{title:"Nombre",data:"name"},{title:"Opciones",data:function(m,M,L){return`\n          <span style="cursor: pointer;" dependency_id="${m.id}" class="badge rounded-pill text-bg-warning">\n            Detalles\n            <i class="fa-solid fa-circle-info fa-fade"  dependency_id="${m.id}" style="color: #000000;"></i>\n          </span>`}}],this.nodes=[]}ngOnInit(){this.dtOptions={ajax:(t,i)=>{this.dependencyService.index().subscribe({next:a=>{i({data:this.dependencyService.flattenDependency(a[0])}),this.nodes=[this.dependencyService.buildDependencyTreeNode(a[0])]},error:a=>{this.as.subscriptionAlert(r.fI.ERROR,r.gW.ERROR,a.error.message)}})},columns:this.columns,responsive:!0,language:Z}}ngAfterViewInit(){this.renderer.listen("document","click",t=>{t.target.hasAttribute("dependency_id")&&this.router.navigate(["/dependency/show/"+t.target.getAttribute("dependency_id")])})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(r.c9),e.Y36(u.u),e.Y36(e.Qsj),e.Y36(d.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["user-index"]],decls:5,vars:0,consts:[["header","Tabla"],["pTemplate","content"],["header","Organigrama"],["datatable","",1,"table","table-hover","table-sm","table-striped",3,"dtOptions"],[1,"bg-dark","text-light"],[3,"value"],["pTemplate","default"],[1,"p-2","text-center"]],template:function(i,a){1&i&&(e.TgZ(0,"p-tabView")(1,"p-tabPanel",0),e.YNc(2,E,3,1,"ng-template",1),e.qZA(),e.TgZ(3,"p-tabPanel",2),e.YNc(4,F,2,1,"ng-template",1),e.qZA()())},dependencies:[f.G,O.jx,I.OE,b.xf,b.x4],encapsulation:2})}return n})();var B=s(3519),Y=s.n(B),D=s(3416);function J(n,p){1&n&&(e.TgZ(0,"div"),e._UZ(1,"i",10),e.qZA())}const y=function(n){return{disabled:n}},V=[{path:"",component:S.t,children:[{path:"index",component:w,title:"P\xe1gina Principal"},{path:"create",component:v,title:"Crear Dependencia"},{path:"edit/:id",component:v,title:"Editar Dependencia"},{path:"show/:id",component:(()=>{class n{constructor(t,i,a,l){this.dependencyService=t,this.activatedRoute=i,this.as=a,this.router=l,this.loaded=!1,this.roles=[]}ngOnInit(){this.activatedRoute.params.pipe((0,g.w)(({id:t})=>this.dependencyService.show(t))).subscribe({next:t=>{this.dependency=Object.values(t)[0],this.loaded=!0},error:({error:t})=>{this.router.navigateByUrl("benefit-employee"),this.as.subscriptionAlert(r.fI.ERROR,r.gW.ERROR,t.message)}})}destroy(){Y().fire({title:"Est\xe1 seguro?",text:"Al eliminar la dependencia se eliminar\xe1 todo registro de la base de datos",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Eliminar!",showClass:{popup:"animate__animated animate__fadeIn"},hideClass:{popup:"animate__animated animate__fadeOutUp"}}).then(t=>{t.isConfirmed&&this.dependencyService.destroy(this.dependency?.id).subscribe({next:i=>{this.router.navigateByUrl("dependency/index"),this.as.subscriptionAlert(r.fI.ELIMINADO,r.gW.SUCCESS)},error:i=>this.as.subscriptionAlert(r.fI.ERROR,r.gW.ERROR,i.message)})})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(u.u),e.Y36(d.gz),e.Y36(r.c9),e.Y36(d.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["dependency-show"]],decls:17,vars:9,consts:[[1,"row"],[1,"col"],[1,"btn-group","float-end","mt-5","mb-5"],["backButton","",1,"btn","btn-outline-secondary"],["aria-current","page",1,"btn","btn-warning",3,"routerLink","ngClass"],[1,"btn","btn-outline-danger",3,"ngClass","click"],[1,"row","px-5"],[1,"col-xs-12","col-md-4","d-flex","flex-column","my-2"],[4,"ngIf"],[1,"form-text"],[1,"fa-solid","fa-spinner","fa-spin","fa-xs"]],template:function(i,a){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),e._uU(4,"Volver"),e.qZA(),e.TgZ(5,"a",4),e._uU(6,"Editar"),e.qZA(),e.TgZ(7,"a",5),e.NdJ("click",function(){return a.destroy()}),e._uU(8,"Eliminar"),e.qZA()()()(),e.TgZ(9,"div",0)(10,"div",1)(11,"div",6)(12,"div",7),e.YNc(13,J,2,0,"div",8),e._uU(14),e.TgZ(15,"span",9),e._uU(16,"Nombre"),e.qZA()()()()()),2&i&&(e.xp6(5),e.MGl("routerLink","/dependency/edit/",null==a.dependency?null:a.dependency.id,""),e.Q6J("ngClass",e.VKq(5,y,!a.loaded)),e.xp6(2),e.Q6J("ngClass",e.VKq(7,y,!a.loaded)),e.xp6(6),e.Q6J("ngIf",!a.loaded),e.xp6(1),e.hij(" ",null==a.dependency?null:a.dependency.name," "))},dependencies:[c.mk,c.O5,d.rH,D.z],encapsulation:2})}return n})(),title:"Ver Dependencia"},{path:"**",redirectTo:"index"}]}];let j=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(V),d.Bz]})}return n})();var Q=s(3162);let z=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[c.ez,f.T,j,o.u5,Q.W,o.UX,C.m]})}return n})()}}]);